{% extends "administrator.html" %}

{% block content %}

<script src="/static/plugins/tapmodo-Jcrop-1902fbc/js/jquery.min.js"></script>
<script src="/static/plugins/tapmodo-Jcrop-1902fbc/js/jquery.Jcrop.js"></script>
<link rel="stylesheet" href="/static/plugins/tapmodo-Jcrop-1902fbc/css/jquery.Jcrop.css" type="text/css" />
<style type="text/css">

/* Apply these styles only when #preview-pane has
   been placed within the Jcrop widget */
.jcrop-holder #preview-pane {
  display: block;
  position: absolute;
  z-index: 2000;
  top: 10px;
  right: 0px;
  padding: 6px;
  border: 1px rgba(0,0,0,.4) solid;
  background-color: white;

  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;

  -webkit-box-shadow: 1px 1px 5px 2px rgba(0, 0, 0, 0.2);
  -moz-box-shadow: 1px 1px 5px 2px rgba(0, 0, 0, 0.2);
  box-shadow: 1px 1px 5px 2px rgba(0, 0, 0, 0.2);
}

/* The Javascript code will set the aspect ratio of the crop
   area based on the size of the thumbnail preview,
   specified here */
#preview-pane .preview-container {
  width: 50px;
  height: 50px;
  overflow: hidden;
}

</style>
<div class="col-md-6">
<div class="box box-info">
            <div class="box-header with-border">
              <h3 class="box-title">个人信息</h3>
            </div>
            <!-- /.box-header -->
            <!-- form start -->
            <form class="form-horizontal" method="post" id="form1" action="/save_info/">
            <input type="hidden" name="t_id" id="cid" value="{{ course.id }}">
              <div class="box-body">
                <div class="form-group">
                  <label class="col-sm-2 control-label">登录名</label>
                  <div class="col-sm-10">
                    <label class=" control-label">{{ user.name }}</label>
                  </div>
                </div>
              </div>
                              <div class="box-body">
                <div class="form-group">
                  <label class="col-sm-2 control-label">密码</label>
                  <div class="col-sm-10">
                      <button type="button" class="btn btn-primary" onclick="changePassword()">修改密码</button>
                  </div>
                </div>
              </div>
                              <div class="box-body">
                <div class="form-group">
                  <label class="col-sm-2 control-label">真实姓名</label>
                  <div class="col-sm-10">
                    <input type="text" class="form-control" name='realname' id="realname" value="{{ user.real_name }}">
                  </div>
                </div>
              </div>

              <!-- /.box-body -->

              <!-- /.box-footer -->
            </form>
             <div class="box-footer">
                <button type="button" class="btn btn-primary" onclick="saveInfo()">保存修改</button>
              </div>
          </div>
</div>
    <div class="col-md-4">
<!--
    <img src="/static/plugins/tapmodo-Jcrop-1902fbc/demo_files/sago.jpg" id="target" alt="[Jcrop Example]" style="width:200px"/>

  <div id="preview-pane" >
    <div class="preview-container">
      <img src="/static/plugins/tapmodo-Jcrop-1902fbc/demo_files/sago.jpg" class="jcrop-preview" alt="Preview"  />
    </div>
  </div>
-->
</div>

<script>

jQuery(function($){

    // Create variables (in this scope) to hold the API and image size
    var jcrop_api,
        boundx,
        boundy,
            showx,
            showy,
        // Grab some information about the preview pane
        $preview = $('#preview-pane'),
        $pcnt = $('#preview-pane .preview-container'),
        $pimg = $('#preview-pane .preview-container img'),
        xsize = $pcnt.width(),
        ysize = $pcnt.height();
        console.log('init',[xsize,ysize]);
    $('#target').Jcrop({
      onChange: updatePreview,
      onSelect: updatePreview,
      aspectRatio: xsize / ysize
    },function(){
      // Use the API to get the real image size
      var bounds = this.getBounds();
      boundx = bounds[0];
      boundy = bounds[1];
        showx=50;
        showy=50;
      // Store the API in the jcrop_api variable
      jcrop_api = this;

      // Move the preview into the jcrop container for css positioning
      $preview.appendTo(jcrop_api.ui.holder);
    });

    function updatePreview(c)
    {
      if (parseInt(c.w) > 0)
      {
        var rx = xsize / c.w;
        var ry = ysize / c.h;

        $pimg.css({
          width: Math.round(rx * showx) + 'px',
          height: Math.round(ry * showy) + 'px',
          marginLeft: '-' + Math.round(rx * c.x) + 'px',
          marginTop: '-' + Math.round(ry * c.y) + 'px'
        });
      }
    };

  });



 function changePassword(){
     self.location.href="/change_password/";
 }
function saveInfo(){
    $('#form1').submit();
}
</script>
{% endblock %}



