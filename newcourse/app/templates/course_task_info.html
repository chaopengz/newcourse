{% extends "course.html" %}

{% block content %}
    <div class="box box-solid">
            <div class="box-header with-border">
              <i class="fa fa-text-width"></i>

              <h3 class="box-title">作业信息</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <dl class="dl-horizontal">
                  <dt>作业名称</dt><dd>{{ task.name }}</dd>
                  <dt>作业要求</dt><dd>{{ task.base_requirements }}</dd>
                  <dt>课程教师</dt><dd>{{ teacher.name }}</dd>
                  <dt>作业可提交日期</dt><dd>{{ task.start_date }} - {{ task.end_date }}</dd>
                  <dt>可执行操作</dt>
                  <dd>
                    <div>
                      <input class="btn bg-olive-active" type="button"  value="一键下载" onclick="">
                    </div>
                  </dd>
              </dl>
            </div>
            <!-- /.box-body -->
          </div>

    <div class="box-body table-responsive no-padding">
           <table class="table table-hover">
                <tr>
                  <th>提交作业序号</th>
                    <th>作业名称</th>
                  <th>提交时间</th>
                    <th>打分</th>
                    <th>评论</th>
                    <th>有无附件</th>
                </tr>
                  {% for task in task_file %}
                    <tr href="/task/">
                        <td>{{ task.id }}</td>
                        <td>{{ task.name }}</td>
                        <td>{{ task.submit_time }}</td>
                        <td><input type="number" id="{{ task.id }}" class="small" value="{{ task.grade }}"></td>
                        <td><input type="text" id="{{ task.id }}" value="{{ task.comment }}"></td>
                        {% ifequal task.is_file 1 %}
                            <td>
                            <input class="btn bg-olive-active" type="button"  value="下载" onclick="">
                            </td>
                        {% endifequal %}
                        {% ifequal task.is_file 0 %}
                            <td><span class="label label-primary">无</span></td>
                        {% endifequal %}
                    </tr>
                  {% endfor %}

           </table>
       </div>

<script>
    $(function () {
        $("input[type='number']").bind('change', function () {
            $.ajax(
                  {
                      url: "/course/task_grade/",
                      type: "POST",
                      data: {
                          "task_id": $(this).attr('id'),
                          "grade": $(this).val()
                      },
                      dataType:"json",
                      success: function (data) {
                          if (data == true) {
                              alert("修改并保存成功");
                          } else {
                              alert("修改失败");
                          }
                      },
                      error: function () {
                          alert("连接失败");
                      }
                  });
        });
        });
 $(function () {
        $("input[type='text']").bind('change', function () {
            $.ajax(
                  {
                      url: "/course/task_comment/",
                      type: "POST",
                      data: {
                          "task_id": $(this).attr('id'),
                          "comment": $(this).val()
                      },
                      dataType:"json",
                      success: function (data) {
                          if (data == true) {
                              alert("修改并保存成功");
                          } else {
                              alert("修改失败");
                          }
                      },
                      error: function () {
                          alert("连接失败");
                      }
                  });
        });
        });
</script>

{% endblock %}

